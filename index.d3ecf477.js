!function(){var e,t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},o=t.parcelRequire7b01;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var o={id:e,exports:{}};return r[e]=o,t.call(o.exports,o,o.exports),o.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){n[e]=t},t.parcelRequire7b01=o),(0,o.register)("f0vaO",function(e,t){Object.defineProperty(e.exports,"DOM",{get:function(){return r},set:void 0,enumerable:!0,configurable:!0});var r={cells:document.querySelectorAll(".tile"),newGameButton:document.querySelector(".button--restart"),tryAgainButton:document.querySelector(".popup__button"),scoreSpan:document.querySelector(".stats__score"),bestSpan:document.querySelector(".stats__best"),message:document.querySelector(".popup__text"),messageBox:document.querySelector(".popup"),themeToggleButton:document.querySelector(".button--theme"),htmlElement:document.documentElement,iconSun:document.querySelector(".icon--sun"),iconMoon:document.querySelector(".icon--moon")}});var a=o("f0vaO"),i={};function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function u(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}i=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.initialState=this.copyBoard(e),this.board=this.copyBoard(e),this.score=0,this.status="idle"}return e=[{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.copyBoard(this.board)}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status="playing",this.board=this.copyBoard(this.initialState),this.score=0,this.addRandomTile(),this.addRandomTile()}},{key:"restart",value:function(){this.status="idle",this.board=this.copyBoard(this.initialState),this.score=0}},{key:"moveLeft",value:function(){var e=this;this.performMove(function(t){return e.merge(t)})}},{key:"moveRight",value:function(){var e=this;this.performMove(function(t){return e.reverse(e.merge(e.reverse(t)))})}},{key:"moveUp",value:function(){var e=this;this.performMove(function(t){var r=e.transpose(t),n=e.merge(r);return e.transpose(n)})}},{key:"moveDown",value:function(){var e=this;this.performMove(function(t){var r=e.transpose(t),n=e.reverse(r),o=e.merge(n),a=e.reverse(o);return e.transpose(a)})}},{key:"performMove",value:function(e){if("playing"===this.status){var t=this.copyBoard(this.board);this.board=e(this.board),this.areBoardsEqual(this.board,t)||this.addRandomTile(),this.has2048()?this.status="win":this.isGameOver()&&(this.status="lose")}}},{key:"areBoardsEqual",value:function(e,t){return e.every(function(e,r){return e.every(function(e,n){return e===t[r][n]})})}},{key:"merge",value:function(e){var t=this;return e.map(function(e){for(var r=e.filter(function(e){return 0!==e}),n=0;n<r.length-1;n++)r[n]===r[n+1]&&(r[n]*=2,t.score+=r[n],r.splice(n+1,1));for(;r.length<4;)r.push(0);return r})}},{key:"transpose",value:function(e){return e[0].map(function(t,r){return e.map(function(e){return e[r]})})}},{key:"reverse",value:function(e){return e.map(function(e){return u(e).reverse()})}},{key:"copyBoard",value:function(e){return e.map(function(e){return u(e)})}},{key:"addRandomTile",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push({r:t,c:r});if(e.length>0){var n=e[Math.floor(Math.random()*e.length)],o=n.r,a=n.c;this.board[o][a]=.9>Math.random()?2:4}}},{key:"has2048",value:function(){return this.board.flat().includes(2048)}},{key:"isGameOver",value:function(){if(this.board.flat().includes(0))return!1;for(var e=0;e<4;e++)for(var t=0;t<4;t++){var r=this.board[e][t];if(e<3&&r===this.board[e+1][t]||t<3&&r===this.board[e][t+1])return!1}return!0}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}();var a=o("f0vaO"),c=[];function l(e){var t,r=e.getState(),n=r.flat(),o=c.flat();(0,a.DOM).cells.forEach(function(e,t){var r=n[t],a=o[t];if(e.className="field-cell",r){var i=String(r).length;e.style.setProperty("--digits",i),e.textContent=r,e.classList.add("field-cell--".concat(r)),0===a&&0!==r?e.classList.add("field-cell--new"):a&&r>a&&e.classList.add("field-cell--merged")}else e.textContent="",e.style.setProperty("--digits",1)}),c=r.map(function(e){return u(e)}),a.DOM.scoreSpan.textContent=e.getScore(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Number(localStorage.getItem("best-score"))||0;e>t?(localStorage.setItem("best-score",e),a.DOM.bestSpan.textContent=e):a.DOM.bestSpan.textContent=t}(e.getScore()),"win"===(t=e.getStatus())?f("\uD83C\uDF89 Winner! Congrats!"):"lose"===t?f("You lose! Restart the game?"):d()}function f(e){a.DOM.message.textContent=e,(0,a.DOM).messageBox.classList.remove("hidden")}function d(){(0,a.DOM).messageBox.classList.add("hidden")}var v=new((e=i)&&e.__esModule?e.default:e);function h(){v.restart(),v.start(),d(),l(v)}var m=0,p=0;v.start(),l(v),(0,a.DOM).newGameButton.addEventListener("click",h),(0,a.DOM).tryAgainButton.addEventListener("click",h),window.addEventListener("keydown",function(e){var t={ArrowLeft:"moveLeft",a:"moveLeft",ArrowRight:"moveRight",d:"moveRight",ArrowUp:"moveUp",w:"moveUp",ArrowDown:"moveDown",s:"moveDown",n:"restart",r:"restart"}[e.key];if(t){if("restart"===t){h();return}"playing"===v.getStatus()&&(v[t](),l(v))}}),window.addEventListener("touchstart",function(e){var t=e.touches[0];m=t.clientX,p=t.clientY},{passive:!0}),window.addEventListener("touchend",function(e){var t=e.changedTouches[0],r=t.clientX-m,n=t.clientY-p,o=Math.abs(r),a=Math.abs(n);30>Math.max(o,a)||"playing"!==v.getStatus()||(o>a?r>0?v.moveRight():v.moveLeft():n>0?v.moveDown():v.moveUp(),l(v))},{passive:!0})}();
//# sourceMappingURL=index.d3ecf477.js.map
